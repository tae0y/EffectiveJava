# ì•„ì´í…œ 37. ordinal ì¸ë±ì‹± ëŒ€ì‹  EnumMapì„ ì‚¬ìš©í•˜ë¼

- Enumì˜ ordinal ë©”ì„œë“œëŠ” í•„ë“œê°€ ì„ ì–¸ëœ ìˆœì„œë¥¼ ë°˜í™˜í•œë‹¤.
- Enumì„ í‚¤ê°’ìœ¼ë¡œ ê°€ì§€ëŠ” EnumMapì´ ìˆëŠ”ë° ì„±ëŠ¥ë„ ì¢‹ë‹¤. ordinalë¡œ ë°°ì—´ ë§Œë“¤ì§€ ë§ê³ , EnumMapì„ ì‚¬ìš©í•˜ì.



## ì•ˆí‹°íŒ¨í„´ 

### 1-1 Enumì˜ ordinalì„ ë°°ì—´ ì¸ë±ìŠ¤ë¡œ ì‚¼ê¸°

- ì•„ë˜ì™€ ê°™ì´ Enumì„ ì‚¬ìš©í•´ í•œí•´ì‚´ì´, ì—¬ëŸ¬í•´ì‚´ì´, ë‘í•´ì‚´ì´ ì‹ë¬¼ì„ í‘œí˜„í•œ ì½”ë“œê°€ ìˆë‹¤.

```java
/**
 * ì‹ë¬¼ì„ ë‚˜íƒ€ë‚´ëŠ” í´ë˜ìŠ¤
 */
public class Plant {
    // ì‹ë¬¼ì˜ ìƒì•  ì£¼ê¸°ë¥¼ ê´€ë¦¬í•˜ëŠ” ì—´ê±° íƒ€ì…
    enum LifeCycle {
        ANNUAL, // í•œí•´ì‚´ì´
        PERENNIAL, // ì—¬ëŸ¬í•´ì‚´ì´
        BIENNIAL // ë‘í•´ì‚´ì´
    }

    final String name;
    final LifeCycle lifeCycle;

    Plant(String name, LifeCycle lifeCycle) {
        this.name = name;
        this.lifeCycle = lifeCycle;
    }

    @Override
    public String toString() {
        return name;
    }
}
```

- í•œí•´ì‚´ì´, ë‘í•´ì‚´ì´..ë¡œ ë¶„ë¥˜í•˜ê³  ì‹¶ë‹¤.
  - ì—´ê±°íƒ€ì…ì˜ valuesë¡œ í•„ë“œë¦¬ìŠ¤íŠ¸ë¥¼ ë°›ì•„ì˜¤ê³ ,
  - í•„ë“œë³„ ordinalì„ ì¸ë±ìŠ¤ë¡œ ì‚¼ì€ Set ë°°ì—´ì„ ë§Œë“¤ì—ˆë‹¤.
  - ê°ê°ì˜ Setì—ëŠ” gardenì„ ìˆœíšŒí•˜ë©° enumì˜ ordinalë¡œ ì•Œë§ì€ ë°°ì—´ì›ì†Œë¥¼ ì°¾ì•„ ì¶”ê°€í–ˆë‹¤.

```java
System.out.println("============= ì½”ë“œ37-1 ===============");

//ì•„ë˜ì™€ ê°™ì€ ë¦¬ìŠ¤íŠ¸ë¥¼
List<Plant> garden = new ArrayList<>();
{
    garden.add(new Plant("í•œí•´ì‚´ì´ê°•ì•„ì§€í’€", Plant.LifeCycle.ANNUAL));
    garden.add(new Plant("í•œí•´ì‚´ì´ë°”ë‚˜ë‚˜", Plant.LifeCycle.ANNUAL));
    garden.add(new Plant("ë°”ì´ë°”ì´ë‚˜ë¬´", Plant.LifeCycle.BIENNIAL));
    garden.add(new Plant("í¼ëŸ¬í¼ëŸ¬ë‚˜ë¬´", Plant.LifeCycle.PERENNIAL));
}

//ì—´ê±°íƒ€ì… ê°’ì— ë”°ë¼ ë‹¤ì‹œ ë¶„ë¥˜í•˜ê³  ì‹¶ë‹¤
//ë¬¸ì œ1) 
Set<Plant>[] plantSet = (Set<Plant>[]) new Set[Plant.LifeCycle.values().length];
for (int i=0; i<plantSet.length; i++){
    plantSet[i] = new HashSet<>();
}

for (Plant p : garden){
    plantSet[p.lifeCycle.ordinal()].add(p);
}

for(int i=0; i<plantSet.length; i++){
    //ë¬¸ì œ2) 
    //ë¬¸ì œ3) 
    System.out.printf("%s : %s%n", Plant.LifeCycle.values()[i], plantSet[i]);
}
```

- ë¬¸ì œ1) ë°°ì—´ì€ ì œë„¤ë¦­ê³¼ í˜¸í™˜ë˜ì§€ ì•Šì•„ ë¹„ê²€ì‚¬ í˜•ë³€í™˜ì„ ìˆ˜í–‰í•´ì•¼ í•œë‹¤.
- ë¬¸ì œ2) ë°°ì—´ì€ ê° ì¸ë±ìŠ¤ì˜ ì˜ë¯¸ë¥¼ ëª¨ë¥´ë¯€ë¡œ ì¶œë ¥ê²°ê³¼ì— ì§ì ‘ ë ˆì´ë¸”ì„ ë‹¬ì•„ì•¼ í•œë‹¤.
- ë¬¸ì œ3) ì¸ë±ìŠ¤ê°€ ìœ íš¨í•œ ë²”ìœ„ì¸ì§€ ì•Œ ìˆ˜ ì—†ë‹¤. ê°œë°œìê°€ ë³´ì¥í•´ì•¼ í•œë‹¤.



  ### 1-2 ë‘ ì—´ê±°íƒ€ì…ì˜ ê°’ì„ ë§¤í•‘í•˜ê¸° ìœ„í•œ ordinalì„ ë‘ë²ˆì“´ ë°°ì—´ë°°ì—´

- ì•„ë˜ì™€ ê°™ì´ ë‘ ê°œì˜ ì—´ê±°íƒ€ì…ì„ ì—°ê²°í•˜ê¸° ìœ„í•´ ordinalì„ ë‘ë²ˆ ì‚¬ìš©í–ˆë‹¤
  - ì»´íŒŒì¼ëŸ¬ëŠ” ordinalê³¼ ë°°ì—´ ì¸ë±ìŠ¤ì˜ ê´€ê³„ë¥¼ ì•Œ ìˆ˜ ì—†ë‹¤.
  - Phaseë‚˜ Transitionì„ ìˆ˜ì •í•˜ë©° TRANSITIONS ì •ì  ë°°ì—´ì„ í•¨ê»˜ ìˆ˜ì •í•˜ì§€ ì•Šìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.
  - ìƒˆë¡œìš´ ì›ì†Œê°€ ì¶”ê°€ë ë•Œë§ˆë‹¤ ë°°ì—´ì˜ í¬ê¸°ê°€ ì œê³±í•´ì„œ ì»¤ì§€ê³ , nullë¡œ ì±„ì›Œì§€ëŠ” ì¹¸ë„ ëŠ˜ì–´ë‚œë‹¤.

```java
public enum Phase {
    SOLID, //0
    LIQUID, //1
    GAS; //2

    public enum Transition {
        MELT,
        FREEZE,
        BOIL,
        CONDENSE,
        SUBLIME,
        DEPOSIT;

        private static final Transition[][] TRANSITIONS = {
                {null, MELT, SUBLIME},//ê³ ì²´>ê¸°ì²´, ìŠ¹í™”
                {FREEZE, null, BOIL},
                {DEPOSIT, CONDENSE, null}
        };

        public static Transition from(Phase from, Phase to) {
            return TRANSITIONS[from.ordinal()][to.ordinal()];
        }
    }
}
```



## ê¶Œì¥íŒ¨í„´ 

### 2-1 enumì„ í‚¤ê°’ìœ¼ë¡œ ê°€ì§€ëŠ” enumMap

- EnumMapì„ ì‚¬ìš©í•˜ì. 
  - ì—´ê±°íƒ€ì…ì„ í‚¤ë¡œ ì‚¬ìš©í•˜ë„ë¡ ì„¤ê³„í•œ ì•„ì£¼ë¹ ë¥¸ ë§µì˜ êµ¬í˜„ì²´ì´ë‹¤.
  - ë‚´ë¶€êµ¬í˜„ì€ ë°°ì—´ë¡œ ë˜ì–´ìˆì–´ ì„±ëŠ¥ìƒ ì œí•œë„ ì—†ê³ , ì¶”ìƒí™”ë˜ì–´ ì œë„¤ë¦­ë„ ì§€ì›í•œë‹¤.


```java
public EnumMap(Class<K> keyType) {
    this.keyType = keyType;
    keyUniverse = getKeyUniverse(keyType);
    vals = new Object[keyUniverse.length]; //ë‚´ë¶€ëŠ” ë°°ì—´ì´ë‹¤!
}
```

```java
System.out.println("============= ì½”ë“œ37-2 ===============");

//ì•„ë˜ì™€ ê°™ì€ ë¦¬ìŠ¤íŠ¸ë¥¼
List<Plant> garden = new ArrayList<>();
{
    garden.add(new Plant("í•œí•´ì‚´ì´ê°•ì•„ì§€í’€", Plant.LifeCycle.ANNUAL));
    garden.add(new Plant("í•œí•´ì‚´ì´ë°”ë‚˜ë‚˜", Plant.LifeCycle.ANNUAL));
    garden.add(new Plant("ë°”ì´ë°”ì´ë‚˜ë¬´", Plant.LifeCycle.BIENNIAL));
    garden.add(new Plant("í¼ëŸ¬í¼ëŸ¬ë‚˜ë¬´", Plant.LifeCycle.PERENNIAL));
}

//ì—´ê±°íƒ€ì…ì— ë”°ë¼ ë‹¤ì‹œ ë¶„ë¥˜í•˜ì
//Mapì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ë‚´ë¶€ëŠ” ë°°ì—´ë¡œ êµ¬í˜„ë˜ì–´ìˆì–´ Mapì˜ íƒ€ì…ì•ˆì •ì„±ê³¼ ë°°ì—´ì˜ ì„±ëŠ¥ì„ ëª¨ë‘ ì–»ì—ˆë‹¤
Map<Plant.LifeCycle, Set<Plant>> plantMap = new EnumMap<>(Plant.LifeCycle.class);

//enumí•„ë“œë³„ë¡œ í•´ë‹¹í•˜ëŠ” ì›ì†Œê°€ ì—†ë”ë¼ë„ ë§µì„ ìƒì„±í•œë‹¤
for(Plant.LifeCycle lc : Plant.LifeCycle.values()){
    plantMap.put(lc, new HashSet<>());
}
for(Plant p : garden) {
    plantMap.get(p.lifeCycle).add(p);
}

System.out.println(plantMap);
```

- ìŠ¤íŠ¸ë¦¼ì„ ì‚¬ìš©í•´ Mapì„ ë§Œë“¤ìˆ˜ë„ ìˆë‹¤
  - ìœ„ ì½”ë“œëŠ” ê° Enumíƒ€ì…ë³„ë¡œ ë¬´ì¡°ê±´ EnumMapì„ ë§Œë“¤ì§€ë§Œ
  - ì•„ë˜ ì½”ë“œëŠ” í•´ë‹¹ Enumíƒ€ì…ì´ ìˆì„ë•Œë§Œ EnumMapì„ ë§Œë“ ë‹¤ëŠ” ì°¨ì´ê°€ ìˆë‹¤

```java
EnumMap<Plant.LifeCycle, Set<Plant>> collect = garden.stream().collect(groupingBy(p -> p.lifeCycle, () -> new EnumMap<>(Plant.LifeCycle.class), toSet()));
        System.out.println(collect);
        System.out.println(Arrays.stream(garden.toArray(new Plant[]{})).collect(groupingBy(p -> p.lifeCycle, () -> new EnumMap<>(Plant.LifeCycle.class), toSet())));
```

  

### 2-2 ë™ì ìœ¼ë¡œ  EnumMapìœ¼ë¡œ í•´ê²°í•˜ê¸°

- Transitionì„ ì•Œê¸°ìœ„í•´ì„œëŠ” ì´ì „ìƒíƒœ(from)ì™€ ì´í›„ìƒíƒœ(to)ê°€ í•„ìš”

- Map ë‘ê°œë¥¼ ì¤‘ë³µí•´ì„œ 

  - ì•ˆìª½ ë§µì€ ì´ì „ìƒíƒœì™€ TRANSITIONì„

  - ë°”ê¹¥ ë§µì€ ì´í›„ ì´í›„ ìƒíƒœì™€ ì•ˆìª½ Mapì„ ì—°ê²°

  - ë§µì„ {í‚¤, ê°’} í˜•íƒœë¡œ í‘œí˜„í•œë‹¤ë©´ ì•„ë˜ì™€ ê°™ìŒ

    ```java
    {SOLID, { {LIQUID, MELT}, {GAS, SUBLIME} }
    ```

- ì½”ë“œë¡œ ë³´ë©´ ì•„ë˜ì™€ ê°™ìŒ

  - ì´ì°¨ì›ë°°ì—´ê³¼ ë‹¬ë¦¬ nullë¡œ ë¶ˆí•„ìš”í•œ ê³µê°„ì„ ì°¨ì§€í•˜ì§€ë„ ì•Šê³ 
  - null exceptionë„ ë‚˜ì§€ ì•ŠìŒ

```java
package com.company;

import java.util.EnumMap;
import java.util.Map;
import java.util.stream.Stream;

import static java.util.stream.Collectors.groupingBy;
import static java.util.stream.Collectors.toMap;

public enum Phase {
    SOLID, LIQUID, GAS;
    //SOLID, LIQUID, GAS, PLASMA;

    public enum Transition {
        MELT(SOLID, LIQUID), FREEZE(LIQUID, SOLID),
        BOIL(LIQUID, GAS), CONDENSE(GAS, LIQUID),
        SUBLIME(SOLID, GAS), DEPOSIT(GAS, SOLID);
        //IONIZE(GAS, PLASMA), DEIONIZE(PLASMA, GAS);

        private final Phase from;
        private final Phase to;

        Transition(Phase from, Phase to) {
            this.from = from;
            this.to = to;
        }

        //fromìœ¼ë¡œ ë¶„ë¥˜í•œ ë§µì„ ìƒì„±í•˜ê³ 
        //ê·¸ ë§µì˜ ê°’ìœ¼ë¡œ toë¡œ ë¶„ë¥˜í•œ ë§µì„ ìƒˆë¡œ ìƒì„±í•œë‹¤
        //SOLID {}
        //LIQUID {}
        //GAS {}
        private static final Map<Phase, Map<Phase, Transition>> m =
                Stream.of(values()) // enum íƒ€ì… ë‘ ê°œë¥¼ ë§¤í•‘í•œ í•„ë“œ ë¦¬ìŠ¤íŠ¸
                .collect(
                        groupingBy(
                                //classifier í‚¤
                                t -> t.from,
                                //supplier ë§µìƒì„±ì, ì–´ë””ì—
                                () -> new EnumMap<>(Phase.class),
                                //collector ì½œë ‰í„°, ì–´ë–»ê²Œ ë‹´ì„ê¹Œ?
                                toMap(
                                        t -> t.to, //í‚¤
                                        t -> t, //ê°’
                                        (x, y) -> y, //ë³‘í•© ????
                                        () -> new EnumMap<>(Phase.class) //ì–´ë””ì— ì €ì¥
                                ))
                );
        /**
         * ìœ„ ì½”ë“œëŠ” ë§ˆì¹˜ ì´ì¤‘ for ë¬¸ê³¼ ê°™ë‹¤
         * for (Transition t : values) {
         *     m.put(t.from, new EnumMap<>(Phase.class));
         	     for(Plant p : garden){
         	     m.get(t.from).put(t.to, t);
         	     }
         *     
         * }
         * */


        public static Transition from(Phase from, Phase to) {
            return m.get(from).get(to);
        }
    }
}
```



## ë“¤ì–´ê°€ê¸° ì „ì—

- **ì•„ì´í…œ35, ordinal ë©”ì„œë“œ ëŒ€ì‹  ì¸ìŠ¤í„´ìŠ¤ í•„ë“œë¥¼ ì‚¬ìš©í•˜ë¼**
  - ëŒ€ë¶€ë¶„ì˜ ì—´ê±°íƒ€ì… ìƒìˆ˜ëŠ” í•˜ë‚˜ì˜ ì •ìˆ˜ê°’ì— ëŒ€ì‘ëœë‹¤
  - ordinal ë©”ì„œë“œëŠ” í•´ë‹¹ ìƒìˆ˜ê°€ ëª‡ë²ˆì§¸ ìœ„ì¹˜ì¸ì§€ë¥¼ ë°˜í™˜í•œë‹¤
  - í•„ë“œë¥¼ ì¶”ê°€/ì‚­ì œí• ë•Œë§ˆë‹¤ ì „ì²´ ì½”ë“œë¥¼ ë³€ê²½í•´ì•¼í•˜ë¯€ë¡œ ì§€ì–‘í•´ì•¼í•œë‹¤

- **enumì˜ ì¸ìŠ¤í„´ìŠ¤ / ì‹±ê¸€í†¤** 
  - ê·¸ë™ì•ˆ ë´ì™”ë˜ ì‹±ê¸€í†¤ê°ì²´ëŠ”, HttpConnection ê°™ì´ í•˜ë‚˜ì˜ ìœ ì¼í•œ ê°ì²´
  - Enumì´ ë³´ì¥í•˜ëŠ” ì‹±ê¸€í†¤ì€, ì—¬ëŸ¬ final í•„ë“œë¥¼ ê°€ì§€ëŠ” ìœ ì¼í•œ ê°ì²´

- ğŸ˜µğŸ˜µ ì•„ì§ ì´í•´ì•ˆë¨.. ë‹¤ìŒì£¼ì— ë‹¤ì‹œ ê³µë¶€í•´ì˜¤ê² ìŠµë‹ˆë‹¤. enum í•„ë“œì´ë¦„ìœ¼ë¡œ ê°’ì„ ì¡°íšŒí•˜ëŠ” ë©”ì„œë“œ ë¶€ì—°ì„¤ëª… / `fromString`, `stringToEnum`
  - [í´ë˜ìŠ¤ ë©¤ë²„ ë³€ìˆ˜ë“¤ì˜ ì´ˆê¸°í™” ìˆœì„œ](https://eyevsky.tistory.com/entry/Java-í´ë˜ìŠ¤-ë©¤ë²„-ë³€ìˆ˜ë“¤ì˜-ì´ˆê¸°í™”-ìˆœì„œ)
